Creating and starting the container...
Removing container
[ERROR] No such file or directory: /raid/enroot/data/user-4154473/mmcl_rvcl
Container removed
Creating new container
[INFO] Extracting squashfs filesystem...
Parallel unsquashfs: Using 8 processors
132418 inodes (238794 blocks) to write


created 130336 files
created 17421 directories
created 1971 symlinks
created 0 devices
created 0 fifos
created 0 sockets
Container created
Starting container
                                                                                                                                                
================
== TensorFlow ==
================

NVIDIA Release 20.12-tf1 (build 18410160)
TensorFlow Version 1.15.4

Container image Copyright (c) 2020, NVIDIA CORPORATION.  All rights reserved.
Copyright 2017-2020 The TensorFlow Authors.  All rights reserved.

NVIDIA Deep Learning Profiler (dlprof) Copyright (c) 2020, NVIDIA CORPORATION.  All rights reserved.

Various files include modifications (c) NVIDIA CORPORATION.  All rights reserved.
NVIDIA modifications are covered by the license terms that apply to the underlying project or file.

NOTE: MOFED driver for multi-node communication was not detected.
      Multi-node communication performance may be reduced.

Installing dependencies from requirements.txt...
Collecting pip
  Using cached pip-25.0.1-py3-none-any.whl (1.8 MB)
Installing collected packages: pip
  Attempting uninstall: pip
    Found existing installation: pip 20.2.4
    Uninstalling pip-20.2.4:
      Successfully uninstalled pip-20.2.4
Successfully installed pip-25.0.1
Found existing installation: onnx 1.8.0
Uninstalling onnx-1.8.0:
  Successfully uninstalled onnx-1.8.0
Collecting onnx==1.9.0
  Using cached onnx-1.9.0-cp38-cp38-manylinux2010_x86_64.whl.metadata (10 kB)
Requirement already satisfied: protobuf in /usr/local/lib/python3.8/dist-packages (from onnx==1.9.0) (3.14.0)
Requirement already satisfied: numpy>=1.16.6 in /usr/local/lib/python3.8/dist-packages (from onnx==1.9.0) (1.17.3)
Requirement already satisfied: six in /usr/local/lib/python3.8/dist-packages (from onnx==1.9.0) (1.13.0)
Requirement already satisfied: typing-extensions>=3.6.2.1 in /usr/local/lib/python3.8/dist-packages (from onnx==1.9.0) (3.7.4.3)
Using cached onnx-1.9.0-cp38-cp38-manylinux2010_x86_64.whl (12.2 MB)
WARNING: Error parsing dependencies of pyzmq: Invalid version: 'cpython'
Installing collected packages: onnx
Successfully installed onnx-1.9.0
Looking in indexes: https://download.pytorch.org/whl/cu118
Collecting torch
  Using cached https://download.pytorch.org/whl/cu118/torch-2.4.1%2Bcu118-cp38-cp38-linux_x86_64.whl (857.6 MB)
Collecting torchvision
  Using cached https://download.pytorch.org/whl/cu118/torchvision-0.19.1%2Bcu118-cp38-cp38-linux_x86_64.whl (6.3 MB)
Collecting torchaudio
  Using cached https://download.pytorch.org/whl/cu118/torchaudio-2.4.1%2Bcu118-cp38-cp38-linux_x86_64.whl (3.3 MB)
Collecting filelock (from torch)
  Using cached https://download.pytorch.org/whl/filelock-3.13.1-py3-none-any.whl.metadata (2.8 kB)
Collecting typing-extensions>=4.8.0 (from torch)
  Using cached https://download.pytorch.org/whl/typing_extensions-4.12.2-py3-none-any.whl.metadata (3.0 kB)
Collecting sympy (from torch)
  Using cached https://download.pytorch.org/whl/sympy-1.13.1-py3-none-any.whl (6.2 MB)
Requirement already satisfied: networkx in /usr/local/lib/python3.8/dist-packages (from torch) (2.5)
Requirement already satisfied: jinja2 in /usr/local/lib/python3.8/dist-packages (from torch) (2.11.2)
Collecting fsspec (from torch)
  Using cached https://download.pytorch.org/whl/fsspec-2024.6.1-py3-none-any.whl.metadata (11 kB)
Collecting nvidia-cuda-nvrtc-cu11==11.8.89 (from torch)
  Using cached https://download.pytorch.org/whl/cu118/nvidia_cuda_nvrtc_cu11-11.8.89-py3-none-manylinux1_x86_64.whl (23.2 MB)
Collecting nvidia-cuda-runtime-cu11==11.8.89 (from torch)
  Using cached https://download.pytorch.org/whl/cu118/nvidia_cuda_runtime_cu11-11.8.89-py3-none-manylinux1_x86_64.whl (875 kB)
Collecting nvidia-cuda-cupti-cu11==11.8.87 (from torch)
  Using cached https://download.pytorch.org/whl/cu118/nvidia_cuda_cupti_cu11-11.8.87-py3-none-manylinux1_x86_64.whl (13.1 MB)
Collecting nvidia-cudnn-cu11==9.1.0.70 (from torch)
  Using cached https://download.pytorch.org/whl/cu118/nvidia_cudnn_cu11-9.1.0.70-py3-none-manylinux2014_x86_64.whl (663.9 MB)
Collecting nvidia-cublas-cu11==11.11.3.6 (from torch)
  Using cached https://download.pytorch.org/whl/cu118/nvidia_cublas_cu11-11.11.3.6-py3-none-manylinux1_x86_64.whl (417.9 MB)
Collecting nvidia-cufft-cu11==10.9.0.58 (from torch)
  Using cached https://download.pytorch.org/whl/cu118/nvidia_cufft_cu11-10.9.0.58-py3-none-manylinux1_x86_64.whl (168.4 MB)
Collecting nvidia-curand-cu11==10.3.0.86 (from torch)
  Using cached https://download.pytorch.org/whl/cu118/nvidia_curand_cu11-10.3.0.86-py3-none-manylinux1_x86_64.whl (58.1 MB)
Collecting nvidia-cusolver-cu11==11.4.1.48 (from torch)
  Using cached https://download.pytorch.org/whl/cu118/nvidia_cusolver_cu11-11.4.1.48-py3-none-manylinux1_x86_64.whl (128.2 MB)
Collecting nvidia-cusparse-cu11==11.7.5.86 (from torch)
  Using cached https://download.pytorch.org/whl/cu118/nvidia_cusparse_cu11-11.7.5.86-py3-none-manylinux1_x86_64.whl (204.1 MB)
Collecting nvidia-nccl-cu11==2.20.5 (from torch)
  Using cached https://download.pytorch.org/whl/cu118/nvidia_nccl_cu11-2.20.5-py3-none-manylinux2014_x86_64.whl (142.9 MB)
Collecting nvidia-nvtx-cu11==11.8.86 (from torch)
  Using cached https://download.pytorch.org/whl/cu118/nvidia_nvtx_cu11-11.8.86-py3-none-manylinux1_x86_64.whl (99 kB)
Collecting triton==3.0.0 (from torch)
  Using cached https://download.pytorch.org/whl/triton-3.0.0-1-cp38-cp38-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (209.4 MB)
Requirement already satisfied: numpy in /usr/local/lib/python3.8/dist-packages (from torchvision) (1.17.3)
Requirement already satisfied: pillow!=8.3.*,>=5.3.0 in /usr/local/lib/python3.8/dist-packages (from torchvision) (6.2.1)
Requirement already satisfied: MarkupSafe>=0.23 in /usr/local/lib/python3.8/dist-packages (from jinja2->torch) (1.1.1)
Requirement already satisfied: decorator>=4.3.0 in /usr/local/lib/python3.8/dist-packages (from networkx->torch) (4.4.2)
Collecting mpmath<1.4,>=1.1.0 (from sympy->torch)
  Using cached https://download.pytorch.org/whl/mpmath-1.3.0-py3-none-any.whl (536 kB)
Using cached https://download.pytorch.org/whl/typing_extensions-4.12.2-py3-none-any.whl (37 kB)
Using cached https://download.pytorch.org/whl/filelock-3.13.1-py3-none-any.whl (11 kB)
Using cached https://download.pytorch.org/whl/fsspec-2024.6.1-py3-none-any.whl (177 kB)
WARNING: Error parsing dependencies of pyzmq: Invalid version: 'cpython'
Installing collected packages: mpmath, typing-extensions, sympy, nvidia-nvtx-cu11, nvidia-nccl-cu11, nvidia-cusparse-cu11, nvidia-curand-cu11, nvidia-cufft-cu11, nvidia-cuda-runtime-cu11, nvidia-cuda-nvrtc-cu11, nvidia-cuda-cupti-cu11, nvidia-cublas-cu11, fsspec, filelock, triton, nvidia-cusolver-cu11, nvidia-cudnn-cu11, torch, torchvision, torchaudio
  Attempting uninstall: typing-extensions
    Found existing installation: typing-extensions 3.7.4.3
    Uninstalling typing-extensions-3.7.4.3:
      Successfully uninstalled typing-extensions-3.7.4.3
Successfully installed filelock-3.13.1 fsspec-2024.6.1 mpmath-1.3.0 nvidia-cublas-cu11-11.11.3.6 nvidia-cuda-cupti-cu11-11.8.87 nvidia-cuda-nvrtc-cu11-11.8.89 nvidia-cuda-runtime-cu11-11.8.89 nvidia-cudnn-cu11-9.1.0.70 nvidia-cufft-cu11-10.9.0.58 nvidia-curand-cu11-10.3.0.86 nvidia-cusolver-cu11-11.4.1.48 nvidia-cusparse-cu11-11.7.5.86 nvidia-nccl-cu11-2.20.5 nvidia-nvtx-cu11-11.8.86 sympy-1.13.1 torch-2.4.1+cu118 torchaudio-2.4.1+cu118 torchvision-0.19.1+cu118 triton-3.0.0 typing-extensions-4.12.2
Collecting numpy==1.18.5 (from -r requirements.txt (line 1))
  Using cached numpy-1.18.5-cp38-cp38-manylinux1_x86_64.whl.metadata (2.1 kB)
Requirement already satisfied: tqdm in /usr/local/lib/python3.8/dist-packages (from -r requirements.txt (line 2)) (4.54.0)
Collecting scikit-learn==1.0.2 (from -r requirements.txt (line 3))
  Using cached scikit_learn-1.0.2-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (10 kB)
Collecting diffdist==0.1 (from -r requirements.txt (line 4))
  Using cached diffdist-0.1-py3-none-any.whl
Collecting matplotlib==3.4.2 (from -r requirements.txt (line 5))
  Using cached matplotlib-3.4.2-cp38-cp38-manylinux1_x86_64.whl.metadata (5.7 kB)
Collecting appdirs (from -r requirements.txt (line 6))
  Using cached appdirs-1.4.4-py2.py3-none-any.whl.metadata (9.0 kB)
Collecting oslo_concurrency (from -r requirements.txt (line 7))
  Using cached oslo.concurrency-6.1.0-py3-none-any.whl.metadata (2.1 kB)
Collecting pandas==1.2.4 (from -r requirements.txt (line 8))
  Using cached pandas-1.2.4-cp38-cp38-manylinux1_x86_64.whl.metadata (4.7 kB)
Collecting scipy==1.7.3 (from -r requirements.txt (line 9))
  Using cached scipy-1.7.3-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (2.2 kB)
Requirement already satisfied: joblib>=0.11 in /usr/local/lib/python3.8/dist-packages (from scikit-learn==1.0.2->-r requirements.txt (line 3)) (0.17.0)
Requirement already satisfied: threadpoolctl>=2.0.0 in /usr/local/lib/python3.8/dist-packages (from scikit-learn==1.0.2->-r requirements.txt (line 3)) (2.1.0)
Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.8/dist-packages (from matplotlib==3.4.2->-r requirements.txt (line 5)) (0.10.0)
Requirement already satisfied: kiwisolver>=1.0.1 in /usr/local/lib/python3.8/dist-packages (from matplotlib==3.4.2->-r requirements.txt (line 5)) (1.3.1)
Requirement already satisfied: pillow>=6.2.0 in /usr/local/lib/python3.8/dist-packages (from matplotlib==3.4.2->-r requirements.txt (line 5)) (6.2.1)
Requirement already satisfied: pyparsing>=2.2.1 in /usr/local/lib/python3.8/dist-packages (from matplotlib==3.4.2->-r requirements.txt (line 5)) (2.4.7)
Requirement already satisfied: python-dateutil>=2.7 in /usr/local/lib/python3.8/dist-packages (from matplotlib==3.4.2->-r requirements.txt (line 5)) (2.8.1)
Requirement already satisfied: pytz>=2017.3 in /usr/local/lib/python3.8/dist-packages (from pandas==1.2.4->-r requirements.txt (line 8)) (2020.4)
Collecting fasteners>=0.7.0 (from oslo_concurrency->-r requirements.txt (line 7))
  Using cached fasteners-0.19-py3-none-any.whl.metadata (4.9 kB)
Collecting oslo.config>=5.2.0 (from oslo_concurrency->-r requirements.txt (line 7))
  Using cached oslo.config-9.6.0-py3-none-any.whl.metadata (3.0 kB)
Collecting oslo.i18n>=3.15.3 (from oslo_concurrency->-r requirements.txt (line 7))
  Using cached oslo.i18n-6.4.0-py3-none-any.whl.metadata (2.1 kB)
Collecting oslo.utils>=3.33.0 (from oslo_concurrency->-r requirements.txt (line 7))
  Using cached oslo.utils-7.3.0-py3-none-any.whl.metadata (2.3 kB)
Collecting pbr>=2.0.0 (from oslo_concurrency->-r requirements.txt (line 7))
  Using cached pbr-6.1.1-py2.py3-none-any.whl.metadata (3.4 kB)
Requirement already satisfied: six in /usr/local/lib/python3.8/dist-packages (from cycler>=0.10->matplotlib==3.4.2->-r requirements.txt (line 5)) (1.13.0)
Requirement already satisfied: PyYAML>=5.1 in /usr/local/lib/python3.8/dist-packages (from oslo.config>=5.2.0->oslo_concurrency->-r requirements.txt (line 7)) (5.3.1)
Collecting debtcollector>=1.2.0 (from oslo.config>=5.2.0->oslo_concurrency->-r requirements.txt (line 7))
  Using cached debtcollector-3.0.0-py3-none-any.whl.metadata (2.3 kB)
Collecting netaddr>=0.7.18 (from oslo.config>=5.2.0->oslo_concurrency->-r requirements.txt (line 7))
  Using cached netaddr-1.3.0-py3-none-any.whl.metadata (5.0 kB)
Requirement already satisfied: requests>=2.18.0 in /usr/local/lib/python3.8/dist-packages (from oslo.config>=5.2.0->oslo_concurrency->-r requirements.txt (line 7)) (2.25.0)
Collecting rfc3986>=1.2.0 (from oslo.config>=5.2.0->oslo_concurrency->-r requirements.txt (line 7))
  Using cached rfc3986-2.0.0-py2.py3-none-any.whl.metadata (6.6 kB)
Collecting stevedore>=1.20.0 (from oslo.config>=5.2.0->oslo_concurrency->-r requirements.txt (line 7))
  Using cached stevedore-5.3.0-py3-none-any.whl.metadata (2.3 kB)
Collecting iso8601>=0.1.11 (from oslo.utils>=3.33.0->oslo_concurrency->-r requirements.txt (line 7))
  Using cached iso8601-2.1.0-py3-none-any.whl.metadata (3.7 kB)
Collecting netifaces>=0.10.4 (from oslo.utils>=3.33.0->oslo_concurrency->-r requirements.txt (line 7))
  Using cached netifaces-0.11.0-cp38-cp38-manylinux_2_5_x86_64.manylinux1_x86_64.whl.metadata (9.0 kB)
Requirement already satisfied: packaging>=20.4 in /usr/local/lib/python3.8/dist-packages (from oslo.utils>=3.33.0->oslo_concurrency->-r requirements.txt (line 7)) (20.4)
Requirement already satisfied: setuptools in /usr/local/lib/python3.8/dist-packages (from pbr>=2.0.0->oslo_concurrency->-r requirements.txt (line 7)) (50.3.2)
Requirement already satisfied: wrapt>=1.7.0 in /usr/local/lib/python3.8/dist-packages (from debtcollector>=1.2.0->oslo.config>=5.2.0->oslo_concurrency->-r requirements.txt (line 7)) (1.12.1)
Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.8/dist-packages (from requests>=2.18.0->oslo.config>=5.2.0->oslo_concurrency->-r requirements.txt (line 7)) (3.0.4)
Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.8/dist-packages (from requests>=2.18.0->oslo.config>=5.2.0->oslo_concurrency->-r requirements.txt (line 7)) (2.10)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in /usr/local/lib/python3.8/dist-packages (from requests>=2.18.0->oslo.config>=5.2.0->oslo_concurrency->-r requirements.txt (line 7)) (1.26.2)
Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.8/dist-packages (from requests>=2.18.0->oslo.config>=5.2.0->oslo_concurrency->-r requirements.txt (line 7)) (2020.11.8)
Using cached numpy-1.18.5-cp38-cp38-manylinux1_x86_64.whl (20.6 MB)
Using cached scikit_learn-1.0.2-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (26.7 MB)
Using cached matplotlib-3.4.2-cp38-cp38-manylinux1_x86_64.whl (10.3 MB)
Using cached pandas-1.2.4-cp38-cp38-manylinux1_x86_64.whl (9.7 MB)
Using cached scipy-1.7.3-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (39.3 MB)
Using cached appdirs-1.4.4-py2.py3-none-any.whl (9.6 kB)
Using cached oslo.concurrency-6.1.0-py3-none-any.whl (48 kB)
Using cached fasteners-0.19-py3-none-any.whl (18 kB)
Using cached oslo.config-9.6.0-py3-none-any.whl (132 kB)
Using cached oslo.i18n-6.4.0-py3-none-any.whl (46 kB)
Using cached oslo.utils-7.3.0-py3-none-any.whl (129 kB)
Using cached pbr-6.1.1-py2.py3-none-any.whl (108 kB)
Using cached debtcollector-3.0.0-py3-none-any.whl (23 kB)
Using cached iso8601-2.1.0-py3-none-any.whl (7.5 kB)
Using cached netaddr-1.3.0-py3-none-any.whl (2.3 MB)
Using cached netifaces-0.11.0-cp38-cp38-manylinux_2_5_x86_64.manylinux1_x86_64.whl (33 kB)
Using cached rfc3986-2.0.0-py2.py3-none-any.whl (31 kB)
Using cached stevedore-5.3.0-py3-none-any.whl (49 kB)
WARNING: Error parsing dependencies of pyzmq: Invalid version: 'cpython'
Installing collected packages: netifaces, diffdist, appdirs, rfc3986, pbr, numpy, netaddr, iso8601, fasteners, debtcollector, stevedore, scipy, pandas, oslo.i18n, matplotlib, scikit-learn, oslo.utils, oslo.config, oslo_concurrency
  Attempting uninstall: numpy
    Found existing installation: numpy 1.17.3
    Uninstalling numpy-1.17.3:
      Successfully uninstalled numpy-1.17.3
  Attempting uninstall: scipy
    Found existing installation: scipy 1.4.1
    Uninstalling scipy-1.4.1:
      Successfully uninstalled scipy-1.4.1
  Attempting uninstall: pandas
    Found existing installation: pandas 0.25.3
    Uninstalling pandas-0.25.3:
      Successfully uninstalled pandas-0.25.3
  Attempting uninstall: matplotlib
    Found existing installation: matplotlib 3.3.2
    Uninstalling matplotlib-3.3.2:
      Successfully uninstalled matplotlib-3.3.2
  Attempting uninstall: scikit-learn
    Found existing installation: scikit-learn 0.23.2
    Uninstalling scikit-learn-0.23.2:
      Successfully uninstalled scikit-learn-0.23.2
Successfully installed appdirs-1.4.4 debtcollector-3.0.0 diffdist-0.1 fasteners-0.19 iso8601-2.1.0 matplotlib-3.4.2 netaddr-1.3.0 netifaces-0.11.0 numpy-1.18.5 oslo.config-9.6.0 oslo.i18n-6.4.0 oslo.utils-7.3.0 oslo_concurrency-6.1.0 pandas-1.2.4 pbr-6.1.1 rfc3986-2.0.0 scikit-learn-1.0.2 scipy-1.7.3 stevedore-5.3.0
Training encoder
Args:

model_save_name  : regular_cl_cnn_4layer_b_bs_32
model            : cnn_4layer_b
name             : 
batch_size       : 32
train_type       : contrastive
dataset          : cifar-10
regular_cl_checkpoint : 
seed             : 1
num_iters        : 200
multiplier       : 2
color_jitter_strength : 0.5
lr               : 0.0001
step_size        : 50
scheduler_gamma  : 0.1
Running on: cuda
Type of model after eval: <class 'torch.nn.modules.container.Sequential'>
Type of model after cutting: Sequential(
  (0): ZeroPad2d((1, 2, 1, 2))
  (1): Conv2d(3, 32, kernel_size=(5, 5), stride=(2, 2))
  (2): ReLU()
  (3): Conv2d(32, 128, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
  (4): ReLU()
  (5): Flatten()
  (6): Linear(in_features=8192, out_features=100, bias=True)
)
Traceback (most recent call last):
  File "train_regular_cl.py", line 58, in <module>
    model = RegularCLModel(hparams=args, device=device)
  File "/workspace/regular_cl.py", line 30, in __init__
    if self.hparams.use_validation:
AttributeError: 'Namespace' object has no attribute 'use_validation'
Training encoder failed, skipping linear evaluation.
